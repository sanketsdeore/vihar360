import{r,j as e,L as v,p as k,u as F,q as L,t as C,v as R,w as $,x as P,y as E,z,A as U,B as A}from"./index-CKb6SvpI.js";import{S as I,N as M,a as B,b as D}from"./swiper-bundle-B3V5w10s.js";function q({listing:s}){const[i,m]=r.useState(null),[l,x]=r.useState(""),o=u=>{x(u.target.value)};return r.useEffect(()=>{(async()=>{try{const p=await(await fetch(`/api/user/${s.userRef}`)).json();m(p)}catch(d){console.log(d)}})()},[s.userRef]),e.jsx(e.Fragment,{children:i&&e.jsxs("div",{className:"bg-white flex flex-col gap-2",children:[e.jsxs("p",{className:"text-lg text-gray-700 font-medium",children:["Contact"," ",e.jsx("span",{className:"font-bold text-gray-900 capitalize",children:i.username})," ","for"," ",e.jsx("span",{className:"font-bold text-indigo-600 capitalize",children:s.name.toLowerCase()})]}),e.jsx("textarea",{name:"message",id:"message",rows:"2",value:l,onChange:o,placeholder:"Enter your message here...",className:"w-full border border-gray-300 p-3 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:outline-none trasition"}),e.jsx(v,{to:`mailto:${i.email}?subject=Regarding ${s.name}&body=${l}`,className:"block w-full text-center bg-indigo-600 text-white font-semibold uppercase rounded-lg py-3 mt-4 shadow-md hover:bg-indigo-700 transition duration-300",children:"Send Message"})]})})}function Y(){I.use([M]);const[s,i]=r.useState(null),[m,l]=r.useState(!1),[x,o]=r.useState(!1),[u,d]=r.useState(!1),[p,S]=r.useState(!1),h=k(),{currentUser:f}=F(t=>t.user),j=4.5,[b,N]=r.useState([]),[c,g]=r.useState({name:"",rating:5,comment:""});r.useEffect(()=>{N([{name:"Abhishek Ahirwar",rating:4.5,comment:"Great place, loved it!"},{name:"Priyanshu Chouhan",rating:4,comment:"Nice but could be cleaner."}]),(async()=>{try{if(!h.listingId){console.error("Listing ID is undefined"),o(!0);return}l(!0);const a=await fetch(`/api/listing/get/${h.listingId}`),n=await a.json();if(!a.ok){console.error("Server Error:",n),o(!0),l(!1);return}i(n),l(!1),o(!1)}catch(a){console.error("Fetch Listing Error:",a),o(!0),l(!1)}})()},[h.listingId]);const y=t=>{t.preventDefault(),!(!c.name||!c.comment)&&(N([...b,c]),g({name:"",rating:5,comment:""}))},w=t=>{const a=[];for(let n=1;n<=5;n++)n<=t?a.push(e.jsx(z,{className:"text-yellow-500"},n)):n-.5===t?a.push(e.jsx(U,{className:"text-yellow-500"},n)):a.push(e.jsx(A,{className:"text-gray-400"},n));return a};return e.jsxs("main",{children:[m&&e.jsx("p",{className:"text-center my-7 text-2xl",children:"Loading..."}),x&&e.jsx("p",{className:"text-center my-7 text-2xl",children:"Something went wrong!"}),s&&!m&&!x&&e.jsxs("div",{children:[e.jsx(B,{navigation:!0,children:s.imageUrls.map(t=>e.jsx(D,{children:e.jsx("div",{className:"h-[550px]",style:{background:`url(${t}) center no-repeat`,backgroundSize:"cover"}})},t))}),e.jsx("div",{className:"fixed top-[13%] right-[3%] z-10 border rounded-full w-12 h-12 flex justify-center items-center bg-slate-100 cursor-pointer",children:e.jsx(L,{className:"text-slate-500",onClick:()=>{navigator.clipboard.writeText(window.location.href),d(!0),setTimeout(()=>{d(!1)},2e3)}})}),u&&e.jsx("p",{className:"fixed top-[23%] right-[5%] z-10 rounded-md bg-slate-100 p-2",children:"Link copied!"}),e.jsxs("div",{className:"flex flex-col max-w-4xl mx-auto p-3 my-7 gap-4",children:[e.jsxs("p",{className:"text-2xl font-semibold capitalize",children:[e.jsx("span",{className:"text-3xl",children:s.name})," - ₹"," ",s.offer?s.discountPrice.toLocaleString("en-US"):s.regularPrice.toLocaleString("en-US"),s.type==="rent"&&" / month"]}),e.jsxs("p",{className:"text-lg font-semibold flex items-center gap-1",children:["Rating : ",w(j),e.jsxs("span",{className:"text-slate-600 ml-2",children:["(",j,")"]})]}),e.jsx("p",{className:"flex items-center mt-1 text-slate-600",children:e.jsxs("a",{href:`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(s.address)}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 hover:underline text-blue-600",children:[e.jsx(C,{className:"text-green-700"}),s.address]})}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("p",{className:"bg-red-900 w-full max-w-[200px] text-white text-center p-1 rounded-md",children:s.type==="rent"?"For Rent":"For Sale"}),s.offer&&e.jsxs("p",{className:"bg-green-900 w-full max-w-[200px] text-white text-center p-1 rounded-md",children:["₹ ",+s.regularPrice-+s.discountPrice," OFF"]})]}),e.jsxs("p",{className:"text-slate-800",children:[e.jsx("span",{className:"font-semibold text-black",children:"Description - "}),s.description]}),e.jsxs("ul",{className:"text-green-900 font-semibold text-sm flex flex-wrap items-center gap-4 sm:gap-6",children:[e.jsxs("li",{className:"flex items-center gap-1 whitespace-nowrap ",children:[e.jsx(R,{className:"text-lg"}),s.bedrooms>1?`${s.bedrooms} beds `:`${s.bedrooms} bed `]}),e.jsxs("li",{className:"flex items-center gap-1 whitespace-nowrap ",children:[e.jsx($,{className:"text-lg"}),s.bathrooms>1?`${s.bathrooms} baths `:`${s.bathrooms} bath `]}),e.jsxs("li",{className:"flex items-center gap-1 whitespace-nowrap ",children:[e.jsx(P,{className:"text-lg"}),s.parking?"Parking spot":"No Parking"]}),e.jsxs("li",{className:"flex items-center gap-1 whitespace-nowrap ",children:[e.jsx(E,{className:"text-lg"}),s.furnished?"Furnished":"Unfurnished"]})]}),f&&s.userRef!==f._id&&!p&&e.jsx("button",{onClick:()=>S(!0),className:"bg-slate-700 text-white rounded-lg uppercase hover:opacity-95 p-3",children:"Contact landlord"}),p&&e.jsx(q,{listing:s}),e.jsxs("div",{className:"mt-10",children:[e.jsx("h2",{className:"text-2xl font-semibold",children:"Feedback Of Users"}),e.jsx("ul",{className:"mt-4",children:b.map((t,a)=>e.jsxs("li",{className:"border p-3 rounded-md my-2",children:[e.jsx("p",{className:"text-lg font-semibold",children:t.name}),e.jsxs("p",{className:"text-sm text-gray-500 flex items-center gap-1",children:[w(t.rating)," (",t.rating,")"]}),e.jsx("p",{className:"text-gray-800",children:t.comment})]},a))}),e.jsx("h3",{className:"text-xl font-semibold mt-6",children:"Leave a Review"}),e.jsxs("form",{className:"mt-4 flex flex-col gap-3",onSubmit:y,children:[e.jsx("input",{type:"text",placeholder:"Your Name",value:c.name,onChange:t=>g({...c,name:t.target.value}),className:"border p-2 rounded-md"}),e.jsx("textarea",{placeholder:"Your Review",value:c.comment,onChange:t=>g({...c,comment:t.target.value}),className:"border p-2 rounded-md"}),e.jsx("button",{type:"submit",className:"bg-blue-600 text-white p-2 rounded-md",children:"Submit"})]})]})]})]})]})}export{Y as default};
