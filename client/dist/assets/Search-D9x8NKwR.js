import{l as S,C as L,r as o,j as e}from"./index-CKb6SvpI.js";import{L as _}from"./ListingItem-B6pM-zhx.js";function F(){const b=S(),f=L(),[t,l]=o.useState({searchTerm:"",type:"all",parking:!1,furnished:!1,offer:!1,sort:"created_at",order:"desc"}),[x,p]=o.useState(!1),[n,m]=o.useState([]),[w,d]=o.useState(!1);o.useEffect(()=>{const s=new URLSearchParams(f.search),a=s.get("searchTerm"),r=s.get("type"),h=s.get("parking"),g=s.get("furnished"),i=s.get("offer"),u=s.get("sort"),j=s.get("order");(a||r||h||g||i||u||j)&&l({searchTerm:a||"",type:r||"all",parking:h==="true",furnished:g==="true",offer:i==="true",sort:u||"created_at",order:j||"desc"}),(async()=>{p(!0),d(!1);const y=s.toString(),N=await(await fetch(`/api/listing/get?${y}`)).json();N.length>8?d(!0):d(!1),m(N),p(!1)})()},[f.search]);const c=s=>{if((s.target.id==="all"||s.target.id==="rent"||s.target.id==="sale")&&l({...t,type:s.target.id}),s.target.id==="searchTerm"&&l({...t,searchTerm:s.target.value}),(s.target.id==="parking"||s.target.id==="furnished"||s.target.id==="offer")&&l({...t,[s.target.id]:!!(s.target.checked||s.target.checked==="true")}),s.target.id==="sort_order"){const a=s.target.value.split("_")[0]||"created_at",r=s.target.value.split("_")[1]||"desc";l({...t,sort:a,order:r})}},v=s=>{s.preventDefault();const a=new URLSearchParams;a.set("searchTerm",t.searchTerm),a.set("type",t.type),a.set("parking",t.parking),a.set("furnished",t.furnished),a.set("offer",t.offer),a.set("sort",t.sort),a.set("order",t.order);const r=a.toString();b(`/search?${r}`)},k=async()=>{const a=n.length,r=new URLSearchParams(f.search);r.set("startIndex",a);const h=r.toString(),i=await(await fetch(`/api/listing/get?${h}`)).json();i.length<9&&d(!1),m([...n,...i])};return e.jsxs("div",{className:"flex flex-col md:flex-row",children:[e.jsx("div",{className:"p-7  border-b-2 md:border-r-2 md:min-h-screen",children:e.jsxs("form",{onSubmit:v,className:"flex flex-col gap-8",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"whitespace-nowrap font-semibold",children:"Search Term:"}),e.jsx("input",{type:"text",id:"searchTerm",placeholder:"Search...",className:"border rounded-lg p-3 w-full",value:t.searchTerm,onChange:c})]}),e.jsxs("div",{className:"flex gap-2 flex-wrap items-center",children:[e.jsx("label",{className:"font-semibold",children:"Type:"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"checkbox",id:"all",className:"w-5",onChange:c,checked:t.type==="all"}),e.jsx("span",{children:"Rent & Sale"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"checkbox",id:"rent",className:"w-5",onChange:c,checked:t.type==="rent"}),e.jsx("span",{children:"Rent"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"checkbox",id:"sale",className:"w-5",onChange:c,checked:t.type==="sale"}),e.jsx("span",{children:"Sale"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"checkbox",id:"offer",className:"w-5",onChange:c,checked:t.offer}),e.jsx("span",{children:"Offer"})]})]}),e.jsxs("div",{className:"flex gap-2 flex-wrap items-center",children:[e.jsx("label",{className:"font-semibold",children:"Amenities:"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"checkbox",id:"parking",className:"w-5",onChange:c,checked:t.parking}),e.jsx("span",{children:"Parking"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"checkbox",id:"furnished",className:"w-5",onChange:c,checked:t.furnished}),e.jsx("span",{children:"Furnished"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"font-semibold",children:"Sort:"}),e.jsxs("select",{onChange:c,defaultValue:"created_at_desc",id:"sort_order",className:"border rounded-lg p-3",children:[e.jsx("option",{value:"regularPrice_desc",children:"Price high to low"}),e.jsx("option",{value:"regularPrice_asc",children:"Price low to hight"}),e.jsx("option",{value:"createdAt_desc",children:"Latest"}),e.jsx("option",{value:"createdAt_asc",children:"Oldest"})]})]}),e.jsx("button",{className:"bg-slate-700 text-white p-3 rounded-lg uppercase hover:opacity-95",children:"Search"})]})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"text-3xl font-semibold border-b p-3 text-slate-700 mt-5",children:"Listing Results:"}),e.jsxs("div",{className:"p-7 flex flex-wrap gap-4",children:[!x&&n.length===0&&e.jsx("p",{className:"text-xl text-slate-700",children:"No listing found!"}),x&&e.jsx("p",{className:"text-xl text-slate-700 text-center w-full",children:"Loading..."}),!x&&n&&n.map((s,a)=>e.jsx(_,{listing:s},s._id?s._id:`listing-${a}`)),w&&e.jsx("button",{onClick:k,className:"text-green-700 hover:underline p-7 text-center w-full",children:"Show more"})]})]})]})}export{F as default};
